function botProtection(){$(".result").find("a").click(function(){var e=$(this).attr("href"),t=!1;return"_blank"==$(this).attr("target")&&(t=!0),$.ajax({url:"/img/cat.jpg",type:"post",data:{mm:$("meta[name=mm]").attr("content")},timeout:2e3}).always(function(){t||(document.location.href=e)}),!!t})}function enableFormResetter(){var e=$("#search-delete-btn"),t=null;$(e).click(function(){null!=t&&(clearTimeout(t),t=null),$("input[name=eingabe]").val(""),$("input[name=eingabe]").focus()}),$("input[name=eingabe]").focusin(function(){$(e).css("display","initial")}),$("input[name=eingabe]").focusout(function(){t=window.setTimeout(function(){$(e).css("display","none"),t=null},500)})}function loadMoreResults(){var e=$("meta[name=searchkey]").attr("content"),t=document.location.href;t+="&loadMore="+e+"&script=yes",t=t.replace("/meta.ger3","/loadMore");var s=!1,n=window.setInterval(function(){s||(s=!0,$.getJSON(t,function(e){if((e.engineDelivered==e.engineCount||e.timeWaiting>15)&&clearInterval(n),void 0!==e.newResults){for(var t in e.newResults){var r=e.newResults[t];if(e.imagesearch){var a=$(".image-container > .image");0==t?$(".image-container").prepend(r):void 0!==a[t]?$(r).insertBefore($(a[t])):void 0!==a[t-1]&&$(r).insertAfter($(a[t-1]))}else{var a=$(".result:not(.ad)");0==t?$(".result.ad").length>0?$(r).insertAfter($($(".result.ad")[$(".result.ad").length-1])):$("#results").prepend(r):void 0!==a[t]?$(r).insertBefore($(a[t])):void 0!==a[t-1]&&$(r).insertAfter($(a[t-1]))}}($(".no-results-error").length>0&&$(".image-container > .image").length>0||$(".result:not(.ad)").length>0)&&($(".no-results-error").remove(),0==$(".alert.alert-danger > ul").children().length&&$(".alert.alert-danger").remove()),console.log(e)}s=!1}))},1e3);console.log(t)}function Results(){localStorage&&(this.prefix="result_",this.sort="chronological",this.results=[])}function Result(e,t,s,n,r,a,i,o,l){this.prefix="result_",null!==l&&void 0!==l||(l=MD5(e+t+s+n+r+a+i)),this.hash=l,this.load()||(this.title=e,this.link=t,this.hosterName=s,this.hosterLink=n,this.anzeigeLink=r,this.description=a,this.anonym=i,this.index=o,this.rank=o,this.added=(new Date).getTime(),this.save())}function b64EncodeUnicode(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}function b64DecodeUnicode(e){return decodeURIComponent(Array.prototype.map.call(atob(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function resultSaver(e){var t=$(".result[data-count="+e+"]"),s=$(".result[data-count="+e+"] .result-title a").html().trim(),n=$(".result[data-count="+e+"] .result-title a").attr("href").trim(),r=$(".result[data-count="+e+"] .result-hoster").html().trim(),a=$(".result[data-count="+e+"] .result-hoster").attr("href").trim(),i=$(".result[data-count="+e+"] .result-link").html().trim(),o=$(".result[data-count="+e+"] .result-description").html().trim(),l=$(".result[data-count="+e+"] .result-open-proxy").attr("href").trim(),u=new Result(s,n,r,a,i,o,l,e,null);results.addResult(u),results.sortResults(),results.updateResultPageInterface();var d=$(".saved-result[data-count="+e+"]");t.length>0&&d.length>0&&$(t).transfer({to:d,duration:1e3})}function t(e,s){if(1==arguments.length){var s=$("html").attr("lang");return t(e,s)}return 2==arguments.length&&translations[s]&&translations[s][e]?translations[s][e]:translations.de[e]}function focusNavBox(){$("#keyboard-nav-info").show(),$("#keyboard-nav-info a").first().focus()}function escKeyPressed(){focusNavBox(),$('input[type="checkbox"]').removeAttr("checked")}function focusResults(){$("#results-entry .result-title a").focus()}function focusFoki(){$("#foki a").first().focus()}function focusSettings(){$("#settings a").focus()}function focusNavigation(){$("#sidebarToggle").prop("checked",!0),$(".sidebar-list a").first().focus()}$(document).ready(function(){botProtection(),enableFormResetter(),loadMoreResults()}),results=new Results,$(document).ready(function(){results.loadAllResults(),results.sortResults(),results.updateResultPageInterface()}),Results.prototype.addResult=function(e){this.results.every(function(t){return t.hash!==e.hash})&&this.results.push(e)},Results.prototype.sortResults=function(){switch(void 0===this.sort&&(this.sort="chronological"),this.sort){case"chronological":this.results.sort(function(e,t){return e.added>t.added?-1:e.added<t.added?1:0});break;case"rank":this.results.sort(function(e,t){return e.rank>t.rank?-1:e.rank<t.rank?1:0});break;case"alphabetical":this.results.sort(function(e,t){return t.hosterName>e.hosterName?-1:t.hosterName<e.hosterName?1:0})}return this},Results.prototype.loadAllResults=function(){for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);if(0===t.indexOf(this.prefix)){t=t.substr(this.prefix.length);var s=new Result(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,t);this.results.push(s)}}},Results.prototype.deleteAllResults=function(){this.results=[];for(var e=[],t=0;t<localStorage.length;t++)if(0===localStorage.key(t).indexOf(this.prefix)){var s=localStorage.key(t);e.push(s)}$.each(e,function(e,t){localStorage.removeItem(t)})},Results.prototype.updateResultPageInterface=function(){if(0===this.results.length)return void $("#savedFoki").remove();if(0===$("#savedFoki").length){var e=$('        <div id="savedFoki">          <h1>'+t("result-saver.title")+"</h1>        </div>        ");$("#additions-container").append(e)}else{$("#savedFoki").html("");var e=$("#savedFoki")}this.addToContainer(e)},Results.prototype.addToContainer=function(e){var s=$('    <div id="saver-options">      <div class="saver-option saver-option-filter">        <input class="form-control" type="text" placeholder="&#xf0b0 '+t("result-saver.filter")+'">      </div>      <div class="saver-option saver-option-sort">        <select class="form-control" style="font-family: FontAwesome, sans-serif;">          <option value="chronological" style="font-family: FontAwesome, sans-serif;">&#xf017 '+t("result-saver.sort.chronological")+'</option>          <option value="rank" style="font-family: FontAwesome, sans-serif;">&#xf162 '+t("result-saver.sort.ranking")+'</option>          <option value="alphabetical" style="font-family: FontAwesome, sans-serif;">&#xf15d '+t("result-saver.sort.alphabetical")+'</option>        </select>      </div>      <div class="saver-option saver-option-delete">        <button class="btn btn-danger btn-md" id="saver-options-delete-btn">          <i class="fa fa-trash-o" aria-hidden="true"></i>          '+t("result-saver.deleteAll")+"        </button>      </div>    </div>  ");$(s).find("select").val(this.sort),$(e).append(s),$(s).find("input").keyup(function(){var e=$(this).val();$("#savedFoki .saved-result-content").each(function(t,s){-1===$(this).html().toLowerCase().indexOf(e.toLowerCase())?$(s).parent().addClass("hidden"):$(s).parent().removeClass("hidden")})}),$(s).find("select").change(function(){var e=$(this).val();results.sort=e,results.sortResults(e).updateResultPageInterface()}),$(s).find("#saver-options-delete-btn").click(function(e){results.deleteAllResults(),results.updateResultPageInterface()}),$.each(this.results,function(t,s){$(e).append(s.toHtml())})},Result.prototype.load=function(){if(!localStorage)return!1;var e=localStorage.getItem(this.prefix+this.hash);if(null===e)return!1;var t=b64DecodeUnicode(e),s=JSON.parse(t);return this.title=s.title,this.link=s.link,this.anzeigeLink=s.anzeigeLink,this.hosterName=s.hosterName,this.hosterLink=s.hosterLink,this.anonym=s.anonym,this.description=s.description,this.added=s.added,this.index=-s.index,this.rank=s.rank,!0},Result.prototype.save=function(){if(!localStorage)return!1;var e={title:this.title,link:this.link,anzeigeLink:this.anzeigeLink,hosterName:this.hosterName,hosterLink:this.hosterLink,anonym:this.anonym,description:this.description,added:this.added,index:this.index,rank:this.rank};return e=JSON.stringify(e),e=b64EncodeUnicode(e),localStorage.setItem(this.prefix+this.hash,e),!0},Result.prototype.setIndex=function(e){this.index=e},Result.prototype.remove=function(){localStorage.removeItem(this.prefix+this.hash);var e=this.hash;results.results.splice(results.results.findIndex(function(t){return t.hash===e}),1),results.updateResultPageInterface()},Result.prototype.toHtml=function(){var e=$('    <div class="saved-result result" data-count="'+this.index+'">      <div class="saved-result-remover remover" title="'+t("result-saver.delete")+'">        <i class="fa fa-trash"></i>      </div>      <div class="saved-result-content">        <div class="result-header">          <div class="result-headline">            <h2 class="result-title">              <a href="'+this.link+'" target="_blank" data-count="1" rel="noopener">                '+this.title+'              </a>            </h2>            <a class="result-hoster" href="'+this.hosterLink+'" target="_blank" data-count="1" rel="noopener">              '+this.hosterName+'            </a>          </div>          <a class="result-link" href="'+this.link+'" target="_blank" rel="noopener">            '+this.anzeigeLink+'          </a>        <div class="result-body">          <div class="description">'+this.description+'</div>        </div>        <div class="result-footer">          <a class="result-open" href="'+this.link+'" target="_self" rel="noopener">            '+t("result-saver.save.this")+'          </a>          <a class="result-open" href="'+this.link+'" target="_blank" rel="noopener">            '+t("result-saver.save.newtab")+'          </a>          <a class="result-open-proxy" onmouseover="$(this).popover(\'show\');" onmouseout="$(this).popover(\'hide\');" data-toggle="popover" data-placement="auto right" data-container="body" data-content="Der Link wird anonymisiert geöffnet. Ihre Daten werden nicht zum Zielserver übertragen. Möglicherweise funktionieren manche Webseiten nicht wie gewohnt." href="'+this.anonym+'" target="_blank" rel="noopener" data-original-title="" title="">            '+t("result-saver.save.anonymous")+"          </a>        </div>      </div>    </div>");return $(e).find(".remover").click({caller:this},function(e){e.data.caller.remove()}),e};var translations={de:{"select-engine":"Bitte mindestens 1 Suchmaschine auswählen.","select-valid-name":"Bitte gültigen Namen eingeben:\n* Keine Sonderzeichen\n* Mindestens 1 Buchstabe\n","confirm-overwrite-name":"Name bereits genutzt.\nÜberschreiben?","saved-settings":"Auf der folgenden Startseite sind Ihre Einstellungen nun einmalig gespeichert. Nach Ihrer ersten Suche sind diese wieder verloren. Wenn Sie diese speichern möchten, können Sie sich allerdings ein Lesezeichen für die generierte Startseite einrichten.","generated-plugin":"Ihr Browserplugin mit den persönlichen Sucheinstellungen wurde generiert. Folgen Sie bitte der Anleitung auf der folgenden Seite um es zu installieren. Beachten Sie: Zuvor sollten Sie ein eventuell bereits installiertes MetaGer-Plugin entfernen.","result-saver.title":"Gespeicherte Ergebnisse","result-saver.filter":"Filtern","result-saver.sort.chronological":"Chronologisch","result-saver.sort.ranking":"MetaGer-Ranking","result-saver.sort.alphabetical":"Alphabetisch (Hostname)","result-saver.delete":"Ergebnis aus dem Speicher löschen","result-saver.deleteAll":'<span class="hidden-xs">Ergebnisse</span> löschen</button>',"result-saver.save.this":"ÖFFNEN","result-saver.save.newtab":"IN NEUEM TAB","result-saver.save.anonymous":"ANONYM ÖFFNEN","close-dropdowns":"Alle zuklappen","open-dropdowns":"Alle aufklappen"},en:{"select-engine":"Please select at least 1 search engine.","select-valid-name":"No characters other than a-z, A-Z, 0-9, ä, ö, ü, ß, -, _ allowed, at least 1 character","confirm-overwrite-name":"Name already in use.\nOverwrite?","saved-settings":"On the following startpage your settings are saved one-time. They will be lost after your first search. Though if you want to save them, you can create a bookmark for the generated startpage.","generated-plugin":"Your browser plugin with personal settings was generated. Please follow the instructions on the following page to install it. Notice that beforehand you might have to delete a former MetaGer plugin.","result-saver.title":"Saved Results","result-saver.filter":"Filter","result-saver.sort.chronological":"Chronological","result-saver.sort.ranking":"MetaGer-Ranking","result-saver.sort.alphabetical":"Alphabetical (Hostname)","result-saver.delete":"Delete saved Result","result-saver.deleteAll":'delete <span class="hidden-xs">results</span>',"result-saver.save.this":"OPEN","result-saver.save.newtab":"IN NEW TAB","result-saver.save.anonymous":"OPEN ANONYMOUSLY","close-dropdowns":"Collapse all","open-dropdowns":"Expand all"},es:{"select-engine":"Por favor, seleccione al menos un motor de búsqueda.","select-valid-name":"Por favor, introduzca un nombre válido constituido por letras y números.","confirm-overwrite-name":"Nombre ya ha sido elegido.\n¿Substituirlo?"}},ctrlInfo=!1;$(document).ready(function(){$(".result, .ad").first().attr("id","results-entry")}),$("label").on("keydown",function(e){"13"==e.keyCode&&($(this).click(),$("a",this))}),$(document).on("keydown",function(e){e=e||window.event,ctrlInfo||"9"!=e.keyCode?"27"==e.keyCode&&escKeyPressed():(focusNavBox(),e.preventDefault(),ctrlInfo=!0)});
